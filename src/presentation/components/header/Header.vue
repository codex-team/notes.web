<template>
  <div class="header">
    <Tab
      v-for="tab in tabs"
      :key="tab.url"
      :url="tab.url"
      :is-active="tab.isActive"
      :title="tab.title"
      @click="$router.push(tab.url)"
      :on-close="closeHeaderTab"
    />
    <Button
      class="header__plus"
      link="/new"
      type="transparent"
      :icon="IconPlus"
    />
    <div class="header__right">
      <LoginButton v-if="!user" />
      <UserPanel
        v-else
        :user="user"
      />
    </div>
  </div>
</template>

<script lang="ts" setup>
import { IconPlus } from '@codexteam/icons';
// import { useI18n } from 'vue-i18n';
import { Tab } from 'codex-ui/vue';
import type { TabParams } from '@/domain/entities/Tab';
import Button from '@/presentation/components/button/Button.vue';
import LoginButton from './HeaderLoginButton.vue';
import UserPanel from './HeaderUser.vue';
// import { useRouter } from 'vue-router';
// import { computed } from 'vue';
import { useAppState } from '@/application/services/useAppState';
import useHeader from '@/application/services/useHeader';

// const { t } = useI18n();
// const { currentRoute } = useRouter();
const { user } = useAppState();

const { tabs, deleteOpenedPage } = useHeader();

const closeHeaderTab = (tab: TabParams): void => {
  deleteOpenedPage({
    title: tab.title,
    url: tab.url,
  });
};

</script>

<style scoped lang="postcss">
.header {
  padding: var(--spacing-ms) var(--spacing-l);
  background-color: var(--base--bg-primary);
  display: flex;
  align-items: center;
  width: 100%;
  max-width: 100%;
  border-bottom: 1px solid var(--base--border);

  &__plus {
    margin-left: var(--spacing-ms);
  }

  &__right {
    margin-left: auto;
  }
}
</style>
